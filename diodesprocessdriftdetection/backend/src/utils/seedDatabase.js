const fs = require('fs');
const path = require('path');
const { parse } = require('csv-parse/sync');

// Data directory
const dataDir = path.join(__dirname, '../../data');
if (!fs.existsSync(dataDir)) {
  fs.mkdirSync(dataDir, { recursive: true });
}

const db = require('../models/database');

// CSV Data embedded (from uploaded files)
const supplierData = `Supplier_ID,Supplier_Name,Tier_Level,Site_Location_Country,Site_Location_City,Site_Function,Supplies_ID,Latitude,Longitude
SUP-0000,Advanced Systems 199,3,Malaysia,Kuala Lumpur,Specialty Chemical Production,SUP-0099,3.19252112638737,101.70482000086629
SUP-0001,Asia Foundry 198,3,Malaysia,Penang,Raw Material Extraction,SUP-0063,5.424909320425142,100.34368537190814
SUP-0002,Global Devices 197,3,Japan,Mie,Specialty Chemical Production,SUP-0095,38.312449182354655,112.22077504969054
SUP-0003,Syn Materials 196,3,Vietnam,Ho Chi Minh City,Specialty Chemical Production,SUP-0142,44.81990691318206,93.41292601227865
SUP-0004,Auto Systems 195,3,Japan,Nagasaki,Rare Gas Sourcing,SUP-0102,29.170761822778037,97.0652053801702
SUP-0005,Precision Fab 194,3,USA,Arizona,Specialty Chemical Production,SUP-0082,33.378374930830255,-112.04336559746889
SUP-0006,Auto Tech 193,3,Japan,Mie,Raw Material Extraction,SUP-0073,20.862739527433877,117.28955459903824
SUP-0007,Precision Materials 192,3,Japan,Mie,Rare Gas Sourcing,SUP-0100,30.271198646628516,98.55802174784354
SUP-0008,Precision Systems 191,3,China,Suzhou,Raw Material Extraction,SUP-0109,36.93832846371702,84.1793339782804
SUP-0009,Auto Logistics 190,3,Vietnam,Hanoi,Specialty Chemical Production,SUP-0065,20.984420568709243,105.88238773856165
SUP-0010,Poly Chem 189,3,Singapore,Tuas,Rare Gas Sourcing,SUP-0128,34.52448451560284,102.15319796362263
SUP-0011,Advanced Corp 188,3,Singapore,Tuas,Specialty Chemical Production,SUP-0115,23.37117453732214,101.53137892084654
SUP-0012,Poly Systems 187,3,Taiwan,Taichung,Rare Gas Sourcing,SUP-0100,34.50806607344841,113.33568061603502
SUP-0013,Poly Tech 186,3,Japan,Kumamoto,Rare Gas Sourcing,SUP-0098,32.750283872403685,130.68224679584407
SUP-0014,Asia Semi 185,3,China,Suzhou,Specialty Chemical Production,SUP-0101,24.082668628907378,92.67752118238683
SUP-0015,Auto Materials 184,3,China,Guangzhou,Rare Gas Sourcing,SUP-0076,42.386465192036084,88.82547434646864
SUP-0016,Innov Materials 183,3,South Korea,Yongin,Specialty Chemical Production,SUP-0146,35.06911043399975,121.58212522031235
SUP-0017,Asia Fab 182,3,Singapore,Tuas,Rare Gas Sourcing,SUP-0132,45.75667916799479,82.19934556504005
SUP-0018,Precision Chem 181,3,China,Suzhou,Raw Material Extraction,SUP-0098,45.87798034453916,108.82985782915534
SUP-0019,Global Corp 180,3,China,Guangzhou,Rare Gas Sourcing,SUP-0137,32.434990107109364,85.72362226907902
SUP-0020,Innov Tech 179,3,Japan,Mie,Specialty Chemical Production,SUP-0116,44.1060698119279,110.99021711556028
SUP-0021,Innov Devices 178,3,Japan,Nagasaki,Specialty Chemical Production,SUP-0154,22.592559733901087,122.24199224839542
SUP-0022,Precision Foundry 177,3,South Korea,Cheonan,Specialty Chemical Production,SUP-0125,36.772054912367174,127.1179026562297
SUP-0023,Precision Semi 176,3,Japan,Nagasaki,Specialty Chemical Production,SUP-0071,29.994155331702387,88.32944073025205
SUP-0024,Asia Fab 175,3,Malaysia,Penang,Rare Gas Sourcing,SUP-0099,5.2998750530944765,100.32547582113479
SUP-0025,Syn Tech 174,3,South Korea,Cheonan,Raw Material Extraction,SUP-0063,36.757253769789344,127.07928884365555
SUP-0026,Global Devices 173,3,Taiwan,New Taipei,Rare Gas Sourcing,SUP-0158,25.970197143828877,110.15105106576205
SUP-0027,Syn Tech 172,3,Taiwan,New Taipei,Rare Gas Sourcing,SUP-0133,25.313207273420353,118.69329362742741
SUP-0028,Innov Foundry 171,3,South Korea,Yongin,Specialty Chemical Production,SUP-0123,42.88114533990959,102.45816120643372
SUP-0029,Advanced Semi 170,3,China,Shanghai,Rare Gas Sourcing,SUP-0148,31.302849374966282,121.49544348137995
SUP-0030,Advanced Fab 169,3,Taiwan,Hsinchu,Specialty Chemical Production,SUP-0088,24.788441612767258,120.9305640870278
SUP-0031,Syn Logistics 168,3,South Korea,Yongin,Rare Gas Sourcing,SUP-0119,28.241677401642733,82.77068758077516
SUP-0032,Precision Semi 167,3,Taiwan,Tainan,Raw Material Extraction,SUP-0118,23.066339326332624,120.1353462002347
SUP-0033,Global Chem 166,3,Taiwan,New Taipei,Rare Gas Sourcing,SUP-0127,45.950502695440285,122.76608213627131
SUP-0034,Syn Corp 165,3,Germany,Munich,Specialty Chemical Production,SUP-0138,33.939713327271235,107.79499392002657
SUP-0035,Global Materials 164,3,Malaysia,Kuala Lumpur,Rare Gas Sourcing,SUP-0117,3.170367490929722,101.65430535257609
SUP-0036,Innov Semi 163,3,Vietnam,Ho Chi Minh City,Specialty Chemical Production,SUP-0093,34.18124557831231,87.463754210236
SUP-0037,Innov Tech 162,3,Singapore,Woodlands,Rare Gas Sourcing,SUP-0122,47.016668128506694,97.17279859221357
SUP-0038,Innov Semi 161,3,Japan,Mie,Specialty Chemical Production,SUP-0069,25.164318997952794,92.37507053826674
SUP-0039,Precision Foundry 160,3,Singapore,Tuas,Specialty Chemical Production,SUP-0102,35.657011454386634,87.89388911479995
SUP-0040,Poly Semi 159,3,China,Suzhou,Raw Material Extraction,SUP-0077,32.28265908989621,96.97620272838371
SUP-0041,Global Systems 158,3,Taiwan,New Taipei,Rare Gas Sourcing,SUP-0079,39.338061898582225,83.33126858295388
SUP-0042,Precision Fab 157,3,Singapore,Tuas,Specialty Chemical Production,SUP-0112,28.555722033625507,116.26795128955582
SUP-0043,Innov Semi 156,3,China,Guangzhou,Specialty Chemical Production,SUP-0067,46.21493776473345,96.5963874791447
SUP-0044,Innov Systems 155,3,South Korea,Gumi,Specialty Chemical Production,SUP-0158,30.534319618637703,128.3632169815043
SUP-0045,Global Corp 154,3,Japan,Nagasaki,Raw Material Extraction,SUP-0157,37.81315322203044,126.8754458394993
SUP-0046,Core Logistics 153,3,Japan,Mie,Raw Material Extraction,SUP-0105,43.783882015905256,120.72503098531894
SUP-0047,Global Tech 152,3,China,Guangzhou,Specialty Chemical Production,SUP-0128,42.168518831831314,114.29992697802551
SUP-0048,Core Fab 151,3,Singapore,Tuas,Specialty Chemical Production,SUP-0088,32.67471052345952,98.02745740191459
SUP-0049,Precision Semi 150,3,China,Guangzhou,Raw Material Extraction,SUP-0109,26.423034020441555,127.32872198602412
SUP-0050,Syn Devices 149,3,China,Suzhou,Specialty Chemical Production,SUP-0152,24.195846273049558,83.7784823677774
SUP-0051,Poly Systems 148,3,Taiwan,New Taipei,Raw Material Extraction,SUP-0139,43.20297804399154,121.66354083019931
SUP-0052,Syn Systems 147,3,Japan,Mie,Rare Gas Sourcing,SUP-0132,30.02914096721435,118.29072419652658
SUP-0053,Innov Fab 146,3,Japan,Kumamoto,Rare Gas Sourcing,SUP-0114,32.8442195627462,130.80180874392786
SUP-0054,Global Devices 145,3,Taiwan,New Taipei,Raw Material Extraction,SUP-0066,24.948346694621065,101.91894284135505
SUP-0055,Asia Logistics 144,3,China,Guangzhou,Raw Material Extraction,SUP-0118,27.082891629920425,102.25964279388286
SUP-0056,Advanced Logistics 143,3,China,Guangzhou,Specialty Chemical Production,SUP-0156,33.42973247031277,106.76228225913121
SUP-0057,Auto Corp 142,3,USA,Texas,Specialty Chemical Production,SUP-0070,30.243568191645007,-97.65057396595117
SUP-0058,Global Systems 141,3,China,Suzhou,Rare Gas Sourcing,SUP-0066,49.48954815248808,103.0603734088876
SUP-0059,Global Logistics 140,3,Germany,Munich,Raw Material Extraction,SUP-0143,35.88717190176072,128.37365950512768
SUP-0060,Global Materials 139,2,Taiwan,Hsinchu,Silicon Wafer Fabrication (300mm),SUP-0062,24.82823580724089,121.04482338901045
SUP-0061,Asia Chem 138,2,Japan,Kumamoto,SiC/GaN Substrate Growth,SUP-0190,32.85917845534669,130.81023320961697
SUP-0062,Innov Materials 137,2,China,Shanghai,Molding Compound Production,SUP-0176,31.184558259918273,121.55106124179565
SUP-0063,Core Chem 136,2,Taiwan,Hsinchu,SiC/GaN Substrate Growth,SUP-0063,24.889282652602354,120.9144076013814
SUP-0064,Asia Logistics 135,2,Malaysia,Kuala Lumpur,Molding Compound Production,SUP-0148,3.045334038160588,101.60065137743422
SUP-0065,Poly Tech 134,2,Singapore,Tuas,Silicon Wafer Fabrication (300mm),SUP-0179,35.159118511044724,91.76388622785518
SUP-0066,Innov Tech 133,2,Japan,Kumamoto,Silicon Wafer Fabrication (300mm),SUP-0182,32.85783525752232,130.76999213685883
SUP-0067,Advanced Tech 132,2,Japan,Kumamoto,Photoresist/Mask Production,SUP-0160,32.74737587946265,130.80595231663057
SUP-0068,Advanced Semi 131,2,Singapore,Tuas,Molding Compound Production,SUP-0183,40.923266892337324,86.92935488570576
SUP-0069,Core Materials 130,2,Singapore,Tuas,Molding Compound Production,SUP-0171,20.108720734855947,84.02828118339254
SUP-0070,Auto Chem 129,2,Vietnam,Ho Chi Minh City,Molding Compound Production,SUP-0189,36.46968166449241,116.28397663831143
SUP-0071,Core Semi 128,2,Japan,Mie,Photoresist/Mask Production,SUP-0175,28.552597230500687,95.04152483806169
SUP-0072,Auto Semi 127,2,Taiwan,New Taipei,SiC/GaN Substrate Growth,SUP-0189,43.739144838241145,102.93671020895484
SUP-0073,Auto Tech 126,2,Japan,Mie,Silicon Wafer Fabrication (300mm),SUP-0191,37.90524643061029,80.77015523717893
SUP-0074,Asia Materials 125,2,Taiwan,Tainan,Photoresist/Mask Production,SUP-0176,23.02296191655519,120.16811284776131
SUP-0075,Advanced Devices 124,2,Singapore,Woodlands,Silicon Wafer Fabrication (300mm),SUP-0193,32.41415064725365,113.31349598529088
SUP-0076,Core Foundry 123,2,Taiwan,New Taipei,Molding Compound Production,SUP-0195,22.03184522658134,106.40063856322782
SUP-0077,Precision Devices 122,2,Japan,Nagasaki,Molding Compound Production,SUP-0188,36.61858558817756,99.54982078629693
SUP-0078,Global Systems 121,2,Taiwan,Tainan,Molding Compound Production,SUP-0175,22.903248446221788,120.2777040032559
SUP-0079,Innov Tech 120,2,China,Guangzhou,Photoresist/Mask Production,SUP-0187,30.369726187396868,116.70135134735406
SUP-0080,Global Tech 119,2,China,Guangzhou,Molding Compound Production,SUP-0177,41.96447668202838,96.63513316764077
SUP-0081,Core Chem 118,2,Taiwan,Tainan,Photoresist/Mask Production,SUP-0167,23.055828518695655,120.2129245799494
SUP-0082,Advanced Corp 117,2,Vietnam,Hanoi,SiC/GaN Substrate Growth,SUP-0173,21.092299536369524,105.76262010740643
SUP-0083,Syn Foundry 116,2,Taiwan,Taichung,Silicon Wafer Fabrication (300mm),SUP-0172,43.24440050533766,102.79274012749948
SUP-0084,Auto Materials 115,2,South Korea,Gumi,Silicon Wafer Fabrication (300mm),SUP-0065,26.07076920744573,82.09837381437
SUP-0085,Core Materials 114,2,Vietnam,Ho Chi Minh City,SiC/GaN Substrate Growth,SUP-0061,49.62434382192423,107.20219306647306
SUP-0086,Advanced Chem 113,2,China,Guangzhou,Molding Compound Production,SUP-0188,25.78927123541301,97.92186845718378
SUP-0087,Advanced Systems 112,2,Vietnam,Ho Chi Minh City,Molding Compound Production,SUP-0167,29.93134442630327,86.30164771562163
SUP-0088,Poly Corp 111,2,South Korea,Cheonan,Silicon Wafer Fabrication (300mm),SUP-0132,36.78732895365214,127.24474471686307
SUP-0089,Asia Devices 110,2,Vietnam,Hanoi,SiC/GaN Substrate Growth,SUP-0167,21.114862093325392,105.85385517070698
SUP-0090,Asia Corp 109,2,South Korea,Yongin,SiC/GaN Substrate Growth,SUP-0193,43.95022802326431,116.37455687689783
SUP-0091,Auto Foundry 108,2,Malaysia,Kuala Lumpur,Molding Compound Production,SUP-0179,3.104242285642919,101.606013782215
SUP-0092,Poly Devices 107,2,Taiwan,Hsinchu,SiC/GaN Substrate Growth,SUP-0173,24.82052432554612,120.9552232145766
SUP-0093,Global Devices 106,2,Taiwan,Tainan,SiC/GaN Substrate Growth,SUP-0060,22.908471032570027,120.29400743501128
SUP-0094,Advanced Corp 105,2,South Korea,Yongin,Molding Compound Production,SUP-0096,30.531690381269442,130.0035353444913
SUP-0095,Core Devices 104,2,Japan,Nagasaki,Molding Compound Production,SUP-0164,48.46463386566924,83.72472047553816
SUP-0096,Core Systems 103,2,Malaysia,Penang,Molding Compound Production,SUP-0167,5.420557879255922,100.20855589367251
SUP-0097,Innov Materials 102,2,Japan,Mie,SiC/GaN Substrate Growth,SUP-0099,38.13414689278537,118.97904515978576
SUP-0098,Core Systems 101,2,Japan,Nagasaki,Photoresist/Mask Production,SUP-0148,43.332032085543716,98.32987258370225
SUP-0099,Advanced Semi 100,2,South Korea,Gumi,Photoresist/Mask Production,SUP-0192,38.24260957149668,113.92750552136388
SUP-0100,Global Chem 99,2,South Korea,Yongin,Silicon Wafer Fabrication (300mm),SUP-0187,42.898426130264646,108.67569572588526
SUP-0101,Asia Fab 98,2,Japan,Kumamoto,Silicon Wafer Fabrication (300mm),SUP-0174,32.712689722517005,130.78713497189588
SUP-0102,Advanced Corp 97,2,Singapore,Tuas,Photoresist/Mask Production,SUP-0156,34.98365334984593,99.30172433728067
SUP-0103,Global Tech 96,2,Taiwan,New Taipei,Photoresist/Mask Production,SUP-0171,27.907966156628053,102.27077099582044
SUP-0104,Advanced Tech 95,2,South Korea,Gumi,Silicon Wafer Fabrication (300mm),SUP-0190,47.41889477063724,104.63057502078807
SUP-0105,Innov Systems 94,2,South Korea,Yongin,Silicon Wafer Fabrication (300mm),SUP-0170,33.55030279591042,124.85150968753247
SUP-0106,Poly Tech 93,2,Japan,Mie,Molding Compound Production,SUP-0071,40.421795361939104,122.24554600768268
SUP-0107,Advanced Corp 92,2,South Korea,Gumi,Silicon Wafer Fabrication (300mm),SUP-0185,22.026438685952915,107.17884047142874
SUP-0108,Global Systems 91,2,Singapore,Tuas,Molding Compound Production,SUP-0126,41.38181312472918,126.4249621129279
SUP-0109,Innov Foundry 90,2,South Korea,Gumi,Molding Compound Production,SUP-0163,35.20286842946456,85.99589812833052
SUP-0110,Poly Foundry 89,2,China,Guangzhou,Molding Compound Production,SUP-0140,43.72199611168439,81.28798357351353
SUP-0111,Syn Devices 88,2,Japan,Kumamoto,SiC/GaN Substrate Growth,SUP-0179,32.812389672524105,130.6572430963304
SUP-0112,Innov Systems 87,2,China,Shanghai,SiC/GaN Substrate Growth,SUP-0167,31.273773931978145,121.47513913096606
SUP-0113,Auto Systems 86,2,Taiwan,Tainan,Molding Compound Production,SUP-0178,22.914750142582246,120.31447594630275
SUP-0114,Syn Chem 85,2,Taiwan,New Taipei,Molding Compound Production,SUP-0175,39.30617947972136,102.46762773929035
SUP-0115,Innov Materials 84,2,Taiwan,Tainan,SiC/GaN Substrate Growth,SUP-0164,23.027958785873334,120.15639262731042
SUP-0116,Precision Foundry 83,2,Singapore,Woodlands,Photoresist/Mask Production,SUP-0192,49.070080872212586,101.5419968941023
SUP-0117,Innov Materials 82,2,Taiwan,Taichung,Molding Compound Production,SUP-0169,23.65776503514839,87.61530549074094
SUP-0118,Core Corp 81,2,China,Guangzhou,Molding Compound Production,SUP-0189,41.36814478686369,97.38013930045788
SUP-0119,Global Corp 80,2,Singapore,Tuas,Molding Compound Production,SUP-0174,45.405022602953515,92.54043373219659
SUP-0120,Advanced Logistics 79,2,South Korea,Gumi,Molding Compound Production,SUP-0184,23.761804459760757,95.14174493439205
SUP-0121,Advanced Tech 78,2,Japan,Nagasaki,SiC/GaN Substrate Growth,SUP-0191,24.98991590580712,127.11209596810654
SUP-0122,Poly Semi 77,2,Taiwan,Taichung,Silicon Wafer Fabrication (300mm),SUP-0118,41.687489053940865,110.26966899997902
SUP-0123,Asia Corp 76,2,Taiwan,Tainan,Molding Compound Production,SUP-0093,22.909092360658267,120.24829074676487
SUP-0124,Poly Foundry 75,2,South Korea,Yongin,Molding Compound Production,SUP-0165,37.35652874450464,112.53981623101265
SUP-0125,Asia Logistics 74,2,Singapore,Woodlands,Photoresist/Mask Production,SUP-0191,39.195168568325734,104.85983733816613
SUP-0126,Innov Chem 73,2,Taiwan,Hsinchu,SiC/GaN Substrate Growth,SUP-0178,24.860937630843146,121.00699816823914
SUP-0127,Poly Materials 72,2,Japan,Mie,Silicon Wafer Fabrication (300mm),SUP-0166,28.834998749479205,83.63657237525136
SUP-0128,Advanced Materials 71,2,Japan,Kumamoto,Silicon Wafer Fabrication (300mm),SUP-0180,32.811332052564126,130.7025164998494
SUP-0129,Syn Chem 70,2,Taiwan,Taichung,Molding Compound Production,SUP-0169,41.62304202652399,116.80506256581032
SUP-0130,Innov Corp 69,2,South Korea,Yongin,SiC/GaN Substrate Growth,SUP-0138,23.935314789721268,98.4908330797952
SUP-0131,Innov Materials 68,2,Singapore,Tuas,Molding Compound Production,SUP-0119,33.9437607877242,93.29294605322124
SUP-0132,Asia Semi 67,2,Japan,Mie,Photoresist/Mask Production,SUP-0160,28.72943563792984,99.15714573115655
SUP-0133,Precision Foundry 66,2,South Korea,Gumi,SiC/GaN Substrate Growth,SUP-0164,45.92471221578177,88.00052051408677
SUP-0134,Syn Devices 65,2,South Korea,Yongin,Photoresist/Mask Production,SUP-0187,29.38110073428017,118.15901372477774
SUP-0135,Poly Corp 64,2,South Korea,Gumi,SiC/GaN Substrate Growth,SUP-0184,34.867426511572894,95.5160706635353
SUP-0136,Innov Semi 63,2,Taiwan,New Taipei,Photoresist/Mask Production,SUP-0196,35.10636277521839,128.30491054539502
SUP-0137,Asia Corp 62,2,Japan,Kumamoto,Molding Compound Production,SUP-0147,32.86646789527364,130.77085200737793
SUP-0138,Syn Chem 61,2,Singapore,Tuas,Molding Compound Production,SUP-0178,34.18704007412457,106.82072301831586
SUP-0139,Core Chem 60,2,Taiwan,Taichung,SiC/GaN Substrate Growth,SUP-0172,46.52644328039019,116.34859063847311
SUP-0140,Auto Logistics 59,2,Japan,Nagasaki,SiC/GaN Substrate Growth,SUP-0166,31.956379690820246,108.5247267793757
SUP-0141,Global Devices 58,2,Japan,Mie,Molding Compound Production,SUP-0162,22.258833315226703,105.16872059168504
SUP-0142,Precision Devices 57,2,Japan,Kumamoto,Photoresist/Mask Production,SUP-0180,32.71376220394472,130.83501656308277
SUP-0143,Global Materials 56,2,Taiwan,Tainan,Photoresist/Mask Production,SUP-0193,22.967817059990512,120.30778971339107
SUP-0144,Global Tech 55,2,Taiwan,Tainan,Photoresist/Mask Production,SUP-0190,23.001824503245036,120.22001558071413
SUP-0145,Innov Foundry 54,2,South Korea,Gumi,Silicon Wafer Fabrication (300mm),SUP-0189,21.325708715082797,86.84656750845505
SUP-0146,Advanced Materials 53,2,Taiwan,Tainan,Molding Compound Production,SUP-0195,23.00310114642945,120.18559316952731
SUP-0147,Auto Fab 52,2,Singapore,Tuas,Photoresist/Mask Production,SUP-0107,38.490166779452565,88.17296616596168
SUP-0148,Auto Logistics 51,2,Japan,Nagasaki,Photoresist/Mask Production,SUP-0197,29.042688153041027,96.8251405735591
SUP-0149,Innov Semi 50,2,Japan,Mie,Silicon Wafer Fabrication (300mm),SUP-0174,41.3253439597119,94.96319979884383
SUP-0150,Advanced Chem 49,2,Japan,Nagasaki,Photoresist/Mask Production,SUP-0199,40.230932202560254,129.0542525217441
SUP-0151,Syn Materials 48,2,Taiwan,New Taipei,Photoresist/Mask Production,SUP-0065,41.66505580754843,114.39710060295559
SUP-0152,Core Materials 47,2,Vietnam,Ho Chi Minh City,Molding Compound Production,SUP-0128,49.06735329019594,119.16072645074391
SUP-0153,Core Devices 46,2,Taiwan,New Taipei,Photoresist/Mask Production,SUP-0194,41.57610578123854,109.20196890061106
SUP-0154,Poly Systems 45,2,Japan,Kumamoto,Molding Compound Production,SUP-0166,32.71955514166007,130.77614537901013
SUP-0155,Global Systems 44,2,Japan,Mie,Silicon Wafer Fabrication (300mm),SUP-0183,20.86909450452972,127.31404601271639
SUP-0156,Auto Semi 43,2,South Korea,Cheonan,Photoresist/Mask Production,SUP-0166,36.84810005218371,127.13207548186455
SUP-0157,Asia Fab 42,2,South Korea,Yongin,Photoresist/Mask Production,SUP-0163,43.323732595995196,126.07321494911427
SUP-0158,Asia Systems 41,2,Taiwan,Hsinchu,Molding Compound Production,SUP-0165,24.74146834099425,120.93500990688521
SUP-0159,Advanced Fab 40,2,Japan,Nagasaki,Silicon Wafer Fabrication (300mm),SUP-0163,39.82955451117804,106.20849405477323
SUP-0160,Syn Chem 39,1,China,Shanghai,Backend Final Test/Packaging,DIODES_CORP,31.200857397728964,121.52439795682974
SUP-0161,Core Devices 38,1,South Korea,Yongin,IC Assembly & Test (OSAT),DIODES_CORP,41.66639950182474,112.18747031598883
SUP-0162,Advanced Materials 37,1,Malaysia,Penang,Advanced Wafer Fabrication (Logic/Power),DIODES_CORP,5.341617330161481,100.22497340759857
SUP-0163,Precision Chem 36,1,USA,Oregon,IC Assembly & Test (OSAT),DIODES_CORP,49.145119655197774,94.82218382281633
SUP-0164,Syn Corp 35,1,China,Shanghai,IC Assembly & Test (OSAT),DIODES_CORP,31.199760634840263,121.55674007495416
SUP-0165,Poly Systems 34,1,Malaysia,Penang,IC Assembly & Test (OSAT),DIODES_CORP,5.254374821146543,100.3153244491565
SUP-0166,Precision Fab 33,1,Vietnam,Hanoi,IC Assembly & Test (OSAT),DIODES_CORP,21.093675492026115,105.94092177267828
SUP-0167,Core Fab 32,1,Taiwan,Tainan,Backend Final Test/Packaging,DIODES_CORP,22.957526068322828,120.26282825749968
SUP-0168,Auto Semi 31,1,Japan,Kumamoto,Advanced Wafer Fabrication (Logic/Power),DIODES_CORP,32.7412887950947,130.7358158526033
SUP-0169,Advanced Corp 30,1,Taiwan,New Taipei,Backend Final Test/Packaging,DIODES_CORP,26.148645002774558,106.968130445562
SUP-0170,Syn Corp 29,1,Taiwan,Hsinchu,Advanced Wafer Fabrication (Logic/Power),DIODES_CORP,24.817366099714164,120.91849160768206
SUP-0171,Asia Systems 28,1,Singapore,Woodlands,Backend Final Test/Packaging,DIODES_CORP,40.12260786147485,106.46257270800784
SUP-0172,Advanced Corp 27,1,Malaysia,Kuala Lumpur,Backend Final Test/Packaging,DIODES_CORP,3.06010898095547,101.74415321161965
SUP-0173,Poly Logistics 26,1,China,Suzhou,IC Assembly & Test (OSAT),DIODES_CORP,20.241263328247896,107.4990097792902
SUP-0174,Syn Logistics 25,1,USA,Oregon,Backend Final Test/Packaging,DIODES_CORP,48.04645266197273,123.85987227064493
SUP-0175,Global Chem 24,1,Japan,Nagasaki,IC Assembly & Test (OSAT),DIODES_CORP,48.94660075030613,96.13997249770546
SUP-0176,Global Devices 23,1,Taiwan,New Taipei,Advanced Wafer Fabrication (Logic/Power),DIODES_CORP,22.690852070724212,108.75129119441715
SUP-0177,Core Chem 22,1,Singapore,Tuas,Advanced Wafer Fabrication (Logic/Power),DIODES_CORP,48.03509434761497,125.73793527812559
SUP-0178,Syn Tech 21,1,Vietnam,Ho Chi Minh City,IC Assembly & Test (OSAT),DIODES_CORP,25.37309558678358,125.96113950740236
SUP-0179,Poly Logistics 20,1,Germany,Munich,Backend Final Test/Packaging,DIODES_CORP,34.9539431956694,126.91564517846743
SUP-0180,Global Fab 19,1,South Korea,Cheonan,Advanced Wafer Fabrication (Logic/Power),DIODES_CORP,36.8235923737329,127.07146013815472
SUP-0181,Global Devices 18,1,Malaysia,Kuala Lumpur,Advanced Wafer Fabrication (Logic/Power),DIODES_CORP,3.2378198940177447,101.6986600967114
SUP-0182,Poly Corp 17,1,Germany,Munich,Advanced Wafer Fabrication (Logic/Power),DIODES_CORP,34.88758455797017,126.92162924084487
SUP-0183,Precision Systems 16,1,Malaysia,Kuala Lumpur,IC Assembly & Test (OSAT),DIODES_CORP,3.0724988525079477,101.68178289420646
SUP-0184,Poly Semi 15,1,USA,Arizona,Backend Final Test/Packaging,DIODES_CORP,33.497323579098456,-112.01184646711494
SUP-0185,Precision Devices 14,1,Vietnam,Hanoi,Advanced Wafer Fabrication (Logic/Power),DIODES_CORP,20.965098982767692,105.92122930085469
SUP-0186,Syn Tech 13,1,Singapore,Tuas,Advanced Wafer Fabrication (Logic/Power),DIODES_CORP,46.91433898531121,121.26683881778516
SUP-0187,Core Logistics 12,1,Japan,Mie,Advanced Wafer Fabrication (Logic/Power),DIODES_CORP,40.00579797742549,89.20378038638401
SUP-0188,Auto Systems 11,1,Singapore,Tuas,Advanced Wafer Fabrication (Logic/Power),DIODES_CORP,27.38851676057466,93.09001518362848
SUP-0189,Advanced Chem 10,1,Singapore,Woodlands,Advanced Wafer Fabrication (Logic/Power),DIODES_CORP,48.66562118532757,94.99957913141957
SUP-0190,Asia Chem 9,1,Germany,Munich,IC Assembly & Test (OSAT),DIODES_CORP,39.52292587846606,114.56207449069774
SUP-0191,Innov Logistics 8,1,Taiwan,Hsinchu,IC Assembly & Test (OSAT),DIODES_CORP,24.800504094247678,121.04902367396325
SUP-0192,Advanced Systems 7,1,Singapore,Woodlands,IC Assembly & Test (OSAT),DIODES_CORP,41.030194202236636,95.63212349640314
SUP-0193,Asia Corp 6,1,Malaysia,Kuala Lumpur,Backend Final Test/Packaging,DIODES_CORP,3.083825720187069,101.61671375643935
SUP-0194,Auto Tech 5,1,Taiwan,Taichung,Backend Final Test/Packaging,DIODES_CORP,24.61671473029319,117.36991098062907
SUP-0195,Global Logistics 4,1,Germany,Munich,Backend Final Test/Packaging,DIODES_CORP,36.48453880208958,103.57422273183352
SUP-0196,Global Chem 3,1,Taiwan,Taichung,Backend Final Test/Packaging,DIODES_CORP,26.60329658966475,92.44789847712643
SUP-0197,Advanced Materials 2,1,Japan,Kumamoto,Backend Final Test/Packaging,DIODES_CORP,32.830753225031174,130.6556205444295
SUP-0198,Syn Systems 1,1,Malaysia,Penang,Backend Final Test/Packaging,DIODES_CORP,5.339529849742187,100.28109741121852
SUP-0199,Global Tech 0,1,Singapore,Tuas,Advanced Wafer Fabrication (Logic/Power),DIODES_CORP,37.14667375438438,87.49668737735767`;

const riskData = `Supplier_ID,Site_Location_Country,Geopolitical_Risk_Index,Natural_Disaster_Risk_Index,Water_Scarcity_Index,Overall_Risk_Score,ESG_Audit_Score,Alternative_Source_Count
SUP-0000,Malaysia,0.467,0.443,0.26,0.461,84,3
SUP-0001,Malaysia,0.525,0.443,0.24,0.486,83,3
SUP-0024,Malaysia,0.476,0.367,0.388,0.471,87,3
SUP-0035,Malaysia,0.437,0.446,0.406,0.473,90,0
SUP-0064,Malaysia,0.424,0.376,0.363,0.466,81,2
SUP-0091,Malaysia,0.522,0.439,0.254,0.483,84,0
SUP-0096,Malaysia,0.338,0.349,0.287,0.398,78,0
SUP-0162,Malaysia,0.582,0.328,0.278,0.477,85,1
SUP-0165,Malaysia,0.572,0.328,0.358,0.5,85,2
SUP-0172,Malaysia,0.451,0.423,0.31,0.476,81,1
SUP-0181,Malaysia,0.503,0.381,0.306,0.456,88,0
SUP-0183,Malaysia,0.579,0.338,0.407,0.569,75,3
SUP-0193,Malaysia,0.492,0.429,0.314,0.5,81,2
SUP-0198,Malaysia,0.49,0.375,0.271,0.432,89,3
SUP-0002,Japan,0.518,0.865,0.245,0.616,86,0
SUP-0004,Japan,0.541,0.931,0.159,0.641,82,0
SUP-0006,Japan,0.537,0.931,0.199,0.637,85,0
SUP-0007,Japan,0.564,0.87,0.227,0.649,83,2
SUP-0013,Japan,0.489,0.955,0.241,0.616,89,1
SUP-0020,Japan,0.565,0.901,0.234,0.663,83,1
SUP-0021,Japan,0.516,0.893,0.205,0.606,87,3
SUP-0023,Japan,0.459,1.0,0.15,0.645,78,2
SUP-0038,Japan,0.558,0.94,0.231,0.643,88,3
SUP-0045,Japan,0.499,0.855,0.204,0.616,81,3
SUP-0046,Japan,0.549,0.893,0.159,0.626,83,1
SUP-0052,Japan,0.521,0.872,0.159,0.59,86,2
SUP-0053,Japan,0.512,0.875,0.176,0.593,86,0
SUP-0061,Japan,0.428,0.83,0.164,0.549,83,3
SUP-0066,Japan,0.516,0.974,0.243,0.663,84,0
SUP-0067,Japan,0.499,0.85,0.199,0.602,83,2
SUP-0071,Japan,0.516,0.859,0.226,0.574,92,3
SUP-0073,Japan,0.495,0.92,0.235,0.642,82,0
SUP-0077,Japan,0.511,0.901,0.205,0.638,81,0
SUP-0095,Japan,0.501,0.925,0.273,0.621,89,1
SUP-0097,Japan,0.608,0.862,0.244,0.661,85,2
SUP-0098,Japan,0.609,0.86,0.158,0.648,82,2
SUP-0101,Japan,0.394,0.874,0.162,0.538,85,2
SUP-0106,Japan,0.517,0.994,0.248,0.683,82,3
SUP-0111,Japan,0.455,0.925,0.134,0.53,94,1
SUP-0121,Japan,0.559,0.877,0.114,0.568,91,3
SUP-0127,Japan,0.494,0.962,0.12,0.616,82,2
SUP-0128,Japan,0.5,0.902,0.177,0.587,88,3
SUP-0132,Japan,0.447,0.893,0.206,0.574,87,0
SUP-0137,Japan,0.536,0.844,0.123,0.55,91,3
SUP-0140,Japan,0.517,0.863,0.278,0.631,85,3
SUP-0141,Japan,0.559,0.903,0.303,0.626,93,2
SUP-0142,Japan,0.488,0.949,0.232,0.599,91,0
SUP-0148,Japan,0.452,0.934,0.253,0.666,76,2
SUP-0149,Japan,0.441,0.798,0.187,0.528,88,0
SUP-0150,Japan,0.575,0.904,0.281,0.714,78,0
SUP-0154,Japan,0.415,0.897,0.219,0.581,84,0
SUP-0155,Japan,0.397,0.896,0.135,0.524,88,2
SUP-0159,Japan,0.518,0.853,0.174,0.624,79,0
SUP-0168,Japan,0.497,0.948,0.151,0.597,87,1
SUP-0175,Japan,0.473,0.86,0.195,0.612,79,1
SUP-0187,Japan,0.472,0.84,0.298,0.61,85,1
SUP-0197,Japan,0.465,0.911,0.194,0.606,83,1
SUP-0003,Vietnam,0.631,0.538,0.373,0.699,67,2
SUP-0009,Vietnam,0.586,0.385,0.324,0.555,76,3
SUP-0036,Vietnam,0.682,0.488,0.429,0.707,71,3
SUP-0070,Vietnam,0.754,0.556,0.394,0.792,65,1
SUP-0082,Vietnam,0.52,0.51,0.362,0.648,62,3
SUP-0085,Vietnam,0.568,0.446,0.484,0.638,74,1
SUP-0087,Vietnam,0.6,0.574,0.404,0.72,65,1
SUP-0089,Vietnam,0.676,0.527,0.348,0.698,69,3
SUP-0152,Vietnam,0.556,0.431,0.446,0.588,79,3
SUP-0166,Vietnam,0.53,0.528,0.367,0.639,67,0
SUP-0178,Vietnam,0.57,0.457,0.402,0.656,65,1
SUP-0185,Vietnam,0.614,0.497,0.388,0.69,65,3
SUP-0005,USA,0.271,0.338,0.325,0.369,80,3
SUP-0057,USA,0.305,0.338,0.217,0.326,87,3
SUP-0163,USA,0.267,0.329,0.262,0.355,75,0
SUP-0174,USA,0.219,0.302,0.313,0.326,80,1
SUP-0184,USA,0.332,0.217,0.297,0.35,78,1
SUP-0008,China,0.767,0.502,0.557,0.825,68,2
SUP-0014,China,0.85,0.471,0.642,0.917,64,0
SUP-0018,China,0.829,0.49,0.619,0.89,66,1
SUP-0019,China,0.804,0.492,0.658,0.86,71,2
SUP-0029,China,0.817,0.479,0.576,0.856,67,2
SUP-0040,China,0.82,0.479,0.614,0.787,80,1
SUP-0043,China,0.844,0.484,0.66,0.905,67,3
SUP-0047,China,0.698,0.45,0.506,0.747,68,0
SUP-0049,China,0.801,0.584,0.616,0.898,68,2
SUP-0050,China,0.841,0.389,0.612,0.809,73,3
SUP-0055,China,0.726,0.557,0.617,0.855,67,2
SUP-0056,China,0.832,0.614,0.609,0.902,71,3
SUP-0058,China,0.777,0.458,0.642,0.865,65,3
SUP-0062,China,0.804,0.476,0.624,0.84,71,0
SUP-0079,China,0.852,0.474,0.587,0.89,65,2
SUP-0080,China,0.778,0.519,0.638,0.888,65,2
SUP-0086,China,0.843,0.568,0.621,0.84,79,3
SUP-0110,China,0.761,0.438,0.511,0.725,77,1
SUP-0112,China,0.833,0.497,0.614,0.906,64,2
SUP-0118,China,0.922,0.506,0.605,0.892,73,0
SUP-0160,China,0.824,0.511,0.56,0.833,72,1
SUP-0164,China,0.894,0.567,0.68,0.973,67,2
SUP-0173,China,0.751,0.494,0.603,0.786,75,0
SUP-0010,Singapore,0.315,0.276,0.792,0.527,82,1
SUP-0011,Singapore,0.349,0.117,0.841,0.491,85,2
SUP-0017,Singapore,0.336,0.135,0.783,0.438,93,0
SUP-0037,Singapore,0.387,0.125,0.788,0.501,83,1
SUP-0039,Singapore,0.265,0.197,0.788,0.45,88,2
SUP-0042,Singapore,0.492,0.256,0.787,0.617,79,1
SUP-0048,Singapore,0.529,0.203,0.801,0.595,84,3
SUP-0065,Singapore,0.41,0.193,0.771,0.535,82,3
SUP-0068,Singapore,0.398,0.173,0.764,0.507,85,1
SUP-0069,Singapore,0.387,0.275,0.667,0.481,90,3
SUP-0075,Singapore,0.462,0.096,0.783,0.525,83,3
SUP-0102,Singapore,0.33,0.161,0.744,0.432,93,1
SUP-0108,Singapore,0.447,0.264,0.836,0.615,79,3
SUP-0116,Singapore,0.374,0.224,0.739,0.491,88,1
SUP-0119,Singapore,0.388,0.181,0.836,0.52,87,1
SUP-0125,Singapore,0.382,0.258,0.746,0.508,88,3
SUP-0131,Singapore,0.43,0.185,0.816,0.576,78,2
SUP-0138,Singapore,0.446,0.191,0.774,0.515,90,1
SUP-0147,Singapore,0.365,0.13,0.722,0.45,88,1
SUP-0171,Singapore,0.336,0.288,0.696,0.46,93,2
SUP-0177,Singapore,0.411,0.195,0.773,0.518,86,3
SUP-0186,Singapore,0.398,0.255,0.806,0.549,85,0
SUP-0188,Singapore,0.382,0.197,0.815,0.566,76,2
SUP-0189,Singapore,0.333,0.237,0.809,0.518,84,0
SUP-0192,Singapore,0.401,0.217,0.773,0.544,81,3
SUP-0199,Singapore,0.41,0.151,0.82,0.565,76,1
SUP-0012,Taiwan,1.0,0.874,0.713,1.016,84,1
SUP-0026,Taiwan,1.0,0.901,0.608,1.083,73,3
SUP-0027,Taiwan,0.919,0.851,0.726,1.042,76,3
SUP-0030,Taiwan,0.959,0.812,0.669,1.06,72,3
SUP-0032,Taiwan,0.904,0.782,0.651,0.91,85,3
SUP-0033,Taiwan,0.903,0.982,0.725,1.047,80,3
SUP-0041,Taiwan,0.907,0.885,0.671,0.996,80,3
SUP-0051,Taiwan,1.0,0.845,0.757,1.092,76,3
SUP-0054,Taiwan,0.948,0.939,0.669,0.956,89,1
SUP-0060,Taiwan,0.985,0.822,0.732,0.998,84,0
SUP-0063,Taiwan,0.981,0.771,0.664,1.004,78,0
SUP-0072,Taiwan,0.946,0.881,0.709,1.086,73,1
SUP-0074,Taiwan,0.969,0.881,0.728,1.001,85,2
SUP-0076,Taiwan,0.992,0.873,0.696,1.119,71,0
SUP-0078,Taiwan,0.971,0.86,0.714,1.093,73,2
SUP-0081,Taiwan,0.896,0.903,0.698,0.981,83,1
SUP-0083,Taiwan,0.951,0.851,0.747,1.058,77,2
SUP-0092,Taiwan,0.955,0.827,0.678,1.017,78,1
SUP-0093,Taiwan,0.961,0.826,0.763,1.076,75,3
SUP-0103,Taiwan,0.941,0.828,0.772,1.028,80,3
SUP-0113,Taiwan,1.0,0.776,0.713,0.982,84,0
SUP-0114,Taiwan,0.954,0.903,0.674,0.966,87,0
SUP-0115,Taiwan,1.0,0.832,0.678,0.964,87,2
SUP-0117,Taiwan,1.0,0.824,0.679,1.038,78,2
SUP-0122,Taiwan,0.883,0.804,0.65,0.979,76,0
SUP-0123,Taiwan,0.948,0.862,0.778,1.089,75,3
SUP-0126,Taiwan,0.999,0.839,0.698,1.007,83,1
SUP-0129,Taiwan,0.894,0.869,0.708,0.98,82,3
SUP-0136,Taiwan,0.964,0.973,0.668,1.08,77,0
SUP-0139,Taiwan,0.919,0.822,0.668,0.937,85,1
SUP-0143,Taiwan,1.0,0.821,0.658,0.996,82,2
SUP-0144,Taiwan,0.922,0.882,0.71,1.084,72,0
SUP-0146,Taiwan,1.0,0.94,0.669,1.077,78,3
SUP-0151,Taiwan,0.964,0.867,0.733,0.952,90,2
SUP-0153,Taiwan,0.941,0.81,0.631,1.003,76,2
SUP-0158,Taiwan,0.948,0.94,0.674,1.028,81,0
SUP-0167,Taiwan,0.949,0.909,0.826,1.107,77,3
SUP-0169,Taiwan,0.926,0.902,0.734,0.956,89,0
SUP-0170,Taiwan,0.979,0.832,0.73,0.989,85,1
SUP-0176,Taiwan,0.991,0.875,0.753,1.018,85,1
SUP-0191,Taiwan,1.0,0.882,0.692,1.047,80,2
SUP-0194,Taiwan,1.0,0.809,0.718,1.047,78,3
SUP-0196,Taiwan,0.951,0.914,0.71,1.041,80,1
SUP-0016,South Korea,0.632,0.637,0.432,0.631,90,1
SUP-0022,South Korea,0.685,0.611,0.412,0.656,87,1
SUP-0025,South Korea,0.695,0.614,0.43,0.71,80,1
SUP-0028,South Korea,0.678,0.61,0.454,0.744,74,0
SUP-0031,South Korea,0.707,0.565,0.46,0.755,72,2
SUP-0044,South Korea,0.672,0.619,0.478,0.724,79,2
SUP-0084,South Korea,0.672,0.694,0.328,0.754,69,1
SUP-0088,South Korea,0.722,0.575,0.349,0.662,83,2
SUP-0090,South Korea,0.712,0.572,0.336,0.646,84,2
SUP-0094,South Korea,0.733,0.595,0.492,0.78,74,2
SUP-0099,South Korea,0.624,0.565,0.398,0.641,81,2
SUP-0100,South Korea,0.688,0.618,0.337,0.635,87,0
SUP-0104,South Korea,0.696,0.656,0.417,0.708,82,1
SUP-0105,South Korea,0.728,0.622,0.432,0.693,86,3
SUP-0107,South Korea,0.71,0.635,0.396,0.67,87,0
SUP-0109,South Korea,0.666,0.69,0.398,0.759,72,2
SUP-0120,South Korea,0.706,0.566,0.442,0.725,76,1
SUP-0124,South Korea,0.678,0.506,0.377,0.713,67,1
SUP-0130,South Korea,0.621,0.638,0.439,0.674,82,1
SUP-0133,South Korea,0.652,0.598,0.4,0.705,74,1
SUP-0134,South Korea,0.775,0.644,0.389,0.744,80,2
SUP-0135,South Korea,0.71,0.498,0.388,0.682,76,1
SUP-0145,South Korea,0.65,0.586,0.49,0.682,83,3
SUP-0156,South Korea,0.671,0.629,0.47,0.694,84,3
SUP-0157,South Korea,0.703,0.568,0.435,0.693,81,1
SUP-0161,South Korea,0.745,0.632,0.452,0.767,77,2
SUP-0180,South Korea,0.766,0.61,0.504,0.794,76,3
SUP-0034,Germany,0.287,0.11,0.067,0.198,82,3
SUP-0059,Germany,0.184,0.121,0.126,0.174,82,3
SUP-0179,Germany,0.199,0.207,0.186,0.223,87,0
SUP-0182,Germany,0.202,0.106,0.131,0.184,79,0
SUP-0190,Germany,0.187,0.017,0.12,0.13,88,3
SUP-0195,Germany,0.176,0.179,0.039,0.167,77,2`;

const componentData = `Diodes_SKU,Component_Name,Supplier_ID,Annual_Volume_Units,Criticality_Flag
DIO-AUTO-PM000,High-Side Power Switch IC,SUP-0197,37197,High
DIO-AUTO-PM000,Epoxy Molding Compound,SUP-0123,22382,High
DIO-AUTO-PM000,SiC Power MOSFET Die,SUP-0168,41973,High
DIO-AUTO-PM001,Epoxy Molding Compound,SUP-0095,84546,High
DIO-AUTO-PM001,Automotive Protection Diode Array,SUP-0116,20729,High
DIO-AUTO-PM001,Low Dropout Regulator (LDO),SUP-0144,20729,High
DIO-AUTO-PM002,Specialty Etching Gas,SUP-0059,88433,High
DIO-AUTO-PM002,Epoxy Molding Compound,SUP-0002,46192,High
DIO-AUTO-PM002,Standard Silicon Wafer (300mm),SUP-0115,17172,High
DIO-AUTO-PM003,SiC Power MOSFET Die,SUP-0167,38587,High
DIO-AUTO-PM003,High-Side Power Switch IC,SUP-0162,17255,High
DIO-AUTO-PM003,Low Dropout Regulator (LDO),SUP-0179,17223,High
DIO-AUTO-PM003,Specialty Etching Gas,SUP-0011,30339,High
DIO-AUTO-PM003,Standard Silicon Wafer (300mm),SUP-0139,5410,High
DIO-AUTO-PM004,GaN HEMT Transistor Die,SUP-0155,6289,High
DIO-AUTO-PM004,Epoxy Molding Compound,SUP-0094,15943,High
DIO-AUTO-PM004,SiC Power MOSFET Die,SUP-0105,11118,High
DIO-AUTO-PM005,Advanced BGA Package Substrate,SUP-0112,32145,High
DIO-AUTO-PM005,Standard Silicon Wafer (300mm),SUP-0112,12090,High
DIO-AUTO-PM005,High-Side Power Switch IC,SUP-0083,8077,High
DIO-AUTO-PM005,Specialty Etching Gas,SUP-0137,80752,High
DIO-AUTO-PM006,Standard Silicon Wafer (300mm),SUP-0115,20868,High
DIO-AUTO-PM006,GaN HEMT Transistor Die,SUP-0173,26387,High
DIO-AUTO-PM006,Epoxy Molding Compound,SUP-0025,7997,High
DIO-AUTO-PM006,Low Dropout Regulator (LDO),SUP-0186,16173,High
DIO-AUTO-PM007,SiC Power MOSFET Die,SUP-0183,27319,High
DIO-AUTO-PM007,Specialty Etching Gas,SUP-0137,9955,High
DIO-AUTO-PM007,Automotive Protection Diode Array,SUP-0108,33765,High
DIO-AUTO-PM007,High-Side Power Switch IC,SUP-0174,15461,High
DIO-AUTO-PM008,High-Side Power Switch IC,SUP-0107,19796,High
DIO-AUTO-PM008,Specialty Etching Gas,SUP-0022,15448,High
DIO-AUTO-PM008,Epoxy Molding Compound,SUP-0005,110023,High
DIO-AUTO-PM008,Automotive Protection Diode Array,SUP-0169,24731,High
DIO-AUTO-PM008,GaN HEMT Transistor Die,SUP-0166,10726,High
DIO-AUTO-PM008,Standard Silicon Wafer (300mm),SUP-0159,48274,High
DIO-AUTO-PM009,High-Side Power Switch IC,SUP-0084,9414,High
DIO-AUTO-PM009,Specialty Etching Gas,SUP-0005,29546,High
DIO-AUTO-PM009,SiC Power MOSFET Die,SUP-0168,5212,High
DIO-AUTO-PM010,SiC Power MOSFET Die,SUP-0174,8639,High
DIO-AUTO-PM010,High-Side Power Switch IC,SUP-0122,29264,High
DIO-AUTO-PM010,Standard Silicon Wafer (300mm),SUP-0185,45134,High
DIO-AUTO-PM010,Specialty Etching Gas,SUP-0009,28673,High
DIO-AUTO-PM010,Epoxy Molding Compound,SUP-0028,22790,High
DIO-AUTO-PM010,Low Dropout Regulator (LDO),SUP-0128,19648,High
DIO-AUTO-PM010,Advanced BGA Package Substrate,SUP-0100,7660,High
DIO-AUTO-PM011,Standard Silicon Wafer (300mm),SUP-0083,14055,High
DIO-AUTO-PM011,Specialty Etching Gas,SUP-0124,17294,High
DIO-AUTO-PM011,GaN HEMT Transistor Die,SUP-0127,58240,High
DIO-AUTO-PM011,Automotive Protection Diode Array,SUP-0105,32909,High
DIO-AUTO-PM012,Low Dropout Regulator (LDO),SUP-0160,6100,High
DIO-AUTO-PM012,SiC Power MOSFET Die,SUP-0183,32399,High
DIO-AUTO-PM012,Specialty Etching Gas,SUP-0096,18371,High
DIO-AUTO-PM012,Advanced BGA Package Substrate,SUP-0140,14546,High
DIO-AUTO-PM012,GaN HEMT Transistor Die,SUP-0171,40781,High
DIO-AUTO-PM013,Standard Silicon Wafer (300mm),SUP-0135,57035,High
DIO-AUTO-PM013,Advanced BGA Package Substrate,SUP-0104,52662,High
DIO-AUTO-PM013,Epoxy Molding Compound,SUP-0095,12775,High
DIO-AUTO-PM014,Automotive Protection Diode Array,SUP-0061,19521,High
DIO-AUTO-PM014,Low Dropout Regulator (LDO),SUP-0057,32586,High
DIO-AUTO-PM014,High-Side Power Switch IC,SUP-0159,54560,High
DIO-AUTO-PM014,GaN HEMT Transistor Die,SUP-0194,17039,High
DIO-AUTO-PM014,Epoxy Molding Compound,SUP-0030,21549,High
DIO-AUTO-PM014,Advanced BGA Package Substrate,SUP-0188,10317,High
DIO-AUTO-PM015,SiC Power MOSFET Die,SUP-0164,9601,High
DIO-AUTO-PM015,Advanced BGA Package Substrate,SUP-0092,47889,High
DIO-AUTO-PM015,High-Side Power Switch IC,SUP-0145,73985,High
DIO-AUTO-PM015,Low Dropout Regulator (LDO),SUP-0052,23600,High
DIO-AUTO-PM015,Standard Silicon Wafer (300mm),SUP-0105,55795,High
DIO-AUTO-PM015,GaN HEMT Transistor Die,SUP-0181,33387,High
DIO-AUTO-PM016,Epoxy Molding Compound,SUP-0131,14921,High
DIO-AUTO-PM016,Standard Silicon Wafer (300mm),SUP-0181,33381,High
DIO-AUTO-PM016,SiC Power MOSFET Die,SUP-0193,85567,High
DIO-AUTO-PM017,SiC Power MOSFET Die,SUP-0178,24293,High
DIO-AUTO-PM017,Low Dropout Regulator (LDO),SUP-0154,87408,High
DIO-AUTO-PM017,High-Side Power Switch IC,SUP-0066,3074,High
DIO-AUTO-PM017,Standard Silicon Wafer (300mm),SUP-0066,48250,High
DIO-AUTO-PM018,Specialty Etching Gas,SUP-0068,26802,High
DIO-AUTO-PM018,High-Side Power Switch IC,SUP-0159,19681,High
DIO-AUTO-PM018,Epoxy Molding Compound,SUP-0001,26904,High
DIO-AUTO-PM018,GaN HEMT Transistor Die,SUP-0122,5097,High
DIO-AUTO-PM019,GaN HEMT Transistor Die,SUP-0178,20970,High
DIO-AUTO-PM019,Epoxy Molding Compound,SUP-0043,33266,High
DIO-AUTO-PM019,Specialty Etching Gas,SUP-0087,81547,High
DIO-AUTO-PM019,Standard Silicon Wafer (300mm),SUP-0092,16514,High
DIO-AUTO-PM020,Standard Silicon Wafer (300mm),SUP-0093,13093,High
DIO-AUTO-PM020,Low Dropout Regulator (LDO),SUP-0092,16734,High
DIO-AUTO-PM020,High-Side Power Switch IC,SUP-0172,51997,High
DIO-AUTO-PM020,Advanced BGA Package Substrate,SUP-0130,32520,High
DIO-AUTO-PM020,Epoxy Molding Compound,SUP-0113,16363,High
DIO-AUTO-PM020,Automotive Protection Diode Array,SUP-0025,37693,High
DIO-AUTO-PM020,GaN HEMT Transistor Die,SUP-0191,27018,High
DIO-AUTO-PM021,Standard Silicon Wafer (300mm),SUP-0145,54260,High
DIO-AUTO-PM021,High-Side Power Switch IC,SUP-0195,14256,High
DIO-AUTO-PM021,Automotive Protection Diode Array,SUP-0056,19235,High
DIO-AUTO-PM021,Advanced BGA Package Substrate,SUP-0182,18268,High
DIO-AUTO-PM021,Epoxy Molding Compound,SUP-0030,7752,High
DIO-AUTO-PM021,SiC Power MOSFET Die,SUP-0065,31682,High
DIO-AUTO-PM022,Specialty Etching Gas,SUP-0068,30806,High
DIO-AUTO-PM022,Advanced BGA Package Substrate,SUP-0090,25102,High
DIO-AUTO-PM022,Automotive Protection Diode Array,SUP-0097,20722,High
DIO-AUTO-PM022,GaN HEMT Transistor Die,SUP-0176,8057,High
DIO-AUTO-PM022,Standard Silicon Wafer (300mm),SUP-0199,17856,High
DIO-AUTO-PM023,Epoxy Molding Compound,SUP-0118,19005,High
DIO-AUTO-PM023,Standard Silicon Wafer (300mm),SUP-0127,13158,High
DIO-AUTO-PM023,Automotive Protection Diode Array,SUP-0043,21973,High
DIO-AUTO-PM023,High-Side Power Switch IC,SUP-0186,34539,High
DIO-AUTO-PM024,Automotive Protection Diode Array,SUP-0047,113049,High
DIO-AUTO-PM024,Specialty Etching Gas,SUP-0137,28747,High
DIO-AUTO-PM024,Standard Silicon Wafer (300mm),SUP-0168,30720,High
DIO-AUTO-PM024,Low Dropout Regulator (LDO),SUP-0015,23554,High
DIO-AUTO-PM024,High-Side Power Switch IC,SUP-0173,5386,High
DIO-AUTO-PROT000,GaN HEMT Transistor Die,SUP-0060,9790,Medium
DIO-AUTO-PROT000,SiC Power MOSFET Die,SUP-0166,10493,Medium
DIO-AUTO-PROT000,Advanced BGA Package Substrate,SUP-0082,71749,Medium
DIO-AUTO-PROT001,GaN HEMT Transistor Die,SUP-0172,8573,Medium
DIO-AUTO-PROT001,Automotive Protection Diode Array,SUP-0116,12728,Medium
DIO-AUTO-PROT001,SiC Power MOSFET Die,SUP-0163,9726,Medium
DIO-AUTO-PROT001,Specialty Etching Gas,SUP-0009,3926,Medium
DIO-AUTO-PROT002,Epoxy Molding Compound,SUP-0002,24949,Medium
DIO-AUTO-PROT002,Specialty Etching Gas,SUP-0129,18249,Medium
DIO-AUTO-PROT002,SiC Power MOSFET Die,SUP-0186,18829,Medium
DIO-AUTO-PROT002,Advanced BGA Package Substrate,SUP-0097,4831,Medium
DIO-AUTO-PROT002,Low Dropout Regulator (LDO),SUP-0137,30717,Medium
DIO-AUTO-PROT002,High-Side Power Switch IC,SUP-0155,3257,Medium
DIO-AUTO-PROT002,Standard Silicon Wafer (300mm),SUP-0061,15991,Medium
DIO-AUTO-PROT003,Advanced BGA Package Substrate,SUP-0088,57682,Medium
DIO-AUTO-PROT003,Automotive Protection Diode Array,SUP-0158,4527,Medium
DIO-AUTO-PROT003,SiC Power MOSFET Die,SUP-0173,6356,Medium
DIO-AUTO-PROT003,Specialty Etching Gas,SUP-0049,10829,Medium
DIO-AUTO-PROT003,Low Dropout Regulator (LDO),SUP-0090,6684,Medium
DIO-AUTO-PROT003,GaN HEMT Transistor Die,SUP-0149,2892,Medium
DIO-AUTO-PROT003,Standard Silicon Wafer (300mm),SUP-0187,10563,Medium
DIO-AUTO-PROT004,GaN HEMT Transistor Die,SUP-0184,4274,Medium
DIO-AUTO-PROT004,Standard Silicon Wafer (300mm),SUP-0090,14606,Medium
DIO-AUTO-PROT004,High-Side Power Switch IC,SUP-0159,4792,Medium
DIO-AUTO-PROT004,Advanced BGA Package Substrate,SUP-0176,34554,Medium
DIO-AUTO-PROT004,Low Dropout Regulator (LDO),SUP-0020,5344,Medium
DIO-AUTO-PROT004,Specialty Etching Gas,SUP-0005,7728,Medium
DIO-AUTO-PROT005,Advanced BGA Package Substrate,SUP-0140,19171,Medium
DIO-AUTO-PROT005,Specialty Etching Gas,SUP-0114,3735,Medium
DIO-AUTO-PROT005,High-Side Power Switch IC,SUP-0073,11995,Medium
DIO-AUTO-PROT006,Automotive Protection Diode Array,SUP-0111,28454,Medium
DIO-AUTO-PROT006,GaN HEMT Transistor Die,SUP-0181,2763,Medium
DIO-AUTO-PROT006,High-Side Power Switch IC,SUP-0190,11591,Medium
DIO-AUTO-PROT007,GaN HEMT Transistor Die,SUP-0170,12310,Medium
DIO-AUTO-PROT007,SiC Power MOSFET Die,SUP-0149,18691,Medium
DIO-AUTO-PROT007,Specialty Etching Gas,SUP-0006,3717,Medium
DIO-AUTO-PROT007,Advanced BGA Package Substrate,SUP-0066,3477,Medium
DIO-AUTO-PROT007,Low Dropout Regulator (LDO),SUP-0175,15182,Medium
DIO-AUTO-PROT008,Specialty Etching Gas,SUP-0043,12681,Medium
DIO-AUTO-PROT008,SiC Power MOSFET Die,SUP-0177,12218,Medium
DIO-AUTO-PROT008,GaN HEMT Transistor Die,SUP-0101,13193,Medium
DIO-AUTO-PROT008,Automotive Protection Diode Array,SUP-0192,5804,Medium
DIO-AUTO-PROT008,Epoxy Molding Compound,SUP-0087,12041,Medium
DIO-AUTO-PROT009,Low Dropout Regulator (LDO),SUP-0061,12642,Medium
DIO-AUTO-PROT009,Automotive Protection Diode Array,SUP-0145,5646,Medium
DIO-AUTO-PROT009,Specialty Etching Gas,SUP-0086,44487,Medium
DIO-AUTO-PROT010,Standard Silicon Wafer (300mm),SUP-0182,14609,Medium
DIO-AUTO-PROT010,Advanced BGA Package Substrate,SUP-0107,3855,Medium
DIO-AUTO-PROT010,Epoxy Molding Compound,SUP-0008,16908,Medium
DIO-AUTO-PROT010,Specialty Etching Gas,SUP-0020,4585,Medium
DIO-AUTO-PROT010,GaN HEMT Transistor Die,SUP-0167,18769,Medium
DIO-AUTO-PROT010,SiC Power MOSFET Die,SUP-0127,25266,Medium
DIO-AUTO-PROT010,Automotive Protection Diode Array,SUP-0019,5186,Medium
DIO-AUTO-PROT011,Advanced BGA Package Substrate,SUP-0187,21612,Medium
DIO-AUTO-PROT011,Standard Silicon Wafer (300mm),SUP-0126,13912,Medium
DIO-AUTO-PROT011,SiC Power MOSFET Die,SUP-0171,19302,Medium
DIO-AUTO-PROT011,Epoxy Molding Compound,SUP-0046,45605,Medium
DIO-AUTO-PROT011,Automotive Protection Diode Array,SUP-0091,8217,Medium
DIO-AUTO-PROT012,Advanced BGA Package Substrate,SUP-0186,5471,Medium
DIO-AUTO-PROT012,Specialty Etching Gas,SUP-0056,4908,Medium
DIO-AUTO-PROT012,GaN HEMT Transistor Die,SUP-0191,5206,Medium
DIO-AUTO-PROT012,Standard Silicon Wafer (300mm),SUP-0092,9401,Medium
DIO-AUTO-PROT012,Low Dropout Regulator (LDO),SUP-0182,13137,Medium
DIO-AUTO-PROT012,High-Side Power Switch IC,SUP-0075,12477,Medium
DIO-AUTO-PROT012,SiC Power MOSFET Die,SUP-0083,19381,Medium
DIO-AUTO-PROT013,Automotive Protection Diode Array,SUP-0189,10104,Medium
DIO-AUTO-PROT013,Advanced BGA Package Substrate,SUP-0112,31989,Medium
DIO-AUTO-PROT013,Standard Silicon Wafer (300mm),SUP-0104,8091,Medium
DIO-AUTO-PROT013,Epoxy Molding Compound,SUP-0077,88121,Medium
DIO-AUTO-PROT013,GaN HEMT Transistor Die,SUP-0084,16496,Medium
DIO-AUTO-PROT014,SiC Power MOSFET Die,SUP-0163,5037,Medium
DIO-AUTO-PROT014,Low Dropout Regulator (LDO),SUP-0194,4245,Medium
DIO-AUTO-PROT014,High-Side Power Switch IC,SUP-0149,14710,Medium
DIO-AUTO-PROT015,Automotive Protection Diode Array,SUP-0110,8362,Medium
DIO-AUTO-PROT015,GaN HEMT Transistor Die,SUP-0168,17703,Medium
DIO-AUTO-PROT015,Epoxy Molding Compound,SUP-0141,14602,Medium
DIO-AUTO-PROT016,Specialty Etching Gas,SUP-0018,9434,Medium
DIO-AUTO-PROT016,Advanced BGA Package Substrate,SUP-0155,5079,Medium
DIO-AUTO-PROT016,SiC Power MOSFET Die,SUP-0178,2976,Medium
DIO-AUTO-PROT016,Epoxy Molding Compound,SUP-0064,6996,Medium
DIO-AUTO-PROT016,Standard Silicon Wafer (300mm),SUP-0112,19840,Medium
DIO-AUTO-PROT016,Automotive Protection Diode Array,SUP-0003,11868,Medium
DIO-AUTO-PROT016,High-Side Power Switch IC,SUP-0155,3691,Medium
DIO-AUTO-PROT017,Advanced BGA Package Substrate,SUP-0176,11486,Medium
DIO-AUTO-PROT017,GaN HEMT Transistor Die,SUP-0164,13610,Medium
DIO-AUTO-PROT017,Standard Silicon Wafer (300mm),SUP-0084,4930,Medium
DIO-AUTO-PROT017,Low Dropout Regulator (LDO),SUP-0035,11308,Medium
DIO-AUTO-PROT017,Epoxy Molding Compound,SUP-0051,10476,Medium
DIO-AUTO-PROT017,Specialty Etching Gas,SUP-0057,4007,Medium
DIO-AUTO-PROT018,Epoxy Molding Compound,SUP-0054,13313,Medium
DIO-AUTO-PROT018,Automotive Protection Diode Array,SUP-0107,15661,Medium
DIO-AUTO-PROT018,SiC Power MOSFET Die,SUP-0159,23784,Medium
DIO-AUTO-PROT018,GaN HEMT Transistor Die,SUP-0170,23234,Medium
DIO-AUTO-PROT018,High-Side Power Switch IC,SUP-0190,3321,Medium
DIO-AUTO-PROT019,Standard Silicon Wafer (300mm),SUP-0181,4722,Medium
DIO-AUTO-PROT019,Low Dropout Regulator (LDO),SUP-0160,15098,Medium
DIO-AUTO-PROT019,GaN HEMT Transistor Die,SUP-0171,15083,Medium
DIO-AUTO-PROT020,High-Side Power Switch IC,SUP-0161,15098,Medium
DIO-AUTO-PROT020,Epoxy Molding Compound,SUP-0080,218060,Medium
DIO-AUTO-PROT020,SiC Power MOSFET Die,SUP-0191,15788,Medium
DIO-AUTO-PROT020,GaN HEMT Transistor Die,SUP-0195,24804,Medium
DIO-AUTO-PROT020,Automotive Protection Diode Array,SUP-0084,21451,Medium
DIO-AUTO-PROT020,Advanced BGA Package Substrate,SUP-0126,16839,Medium
DIO-AUTO-PROT020,Standard Silicon Wafer (300mm),SUP-0105,7770,Medium
DIO-AUTO-PROT021,Automotive Protection Diode Array,SUP-0080,18352,Medium
DIO-AUTO-PROT021,Low Dropout Regulator (LDO),SUP-0045,5388,Medium
DIO-AUTO-PROT021,Specialty Etching Gas,SUP-0087,8274,Medium
DIO-AUTO-PROT021,Epoxy Molding Compound,SUP-0062,6782,Medium
DIO-AUTO-PROT021,GaN HEMT Transistor Die,SUP-0155,10676,Medium
DIO-AUTO-PROT021,High-Side Power Switch IC,SUP-0187,63708,Medium
DIO-AUTO-PROT022,High-Side Power Switch IC,SUP-0088,2245,Medium
DIO-AUTO-PROT022,Standard Silicon Wafer (300mm),SUP-0145,17315,Medium
DIO-AUTO-PROT022,Specialty Etching Gas,SUP-0042,2752,Medium
DIO-AUTO-PROT022,Automotive Protection Diode Array,SUP-0151,6855,Medium
DIO-AUTO-PROT022,Advanced BGA Package Substrate,SUP-0139,23896,Medium
DIO-AUTO-PROT022,Epoxy Molding Compound,SUP-0039,10527,Medium
DIO-AUTO-PROT023,SiC Power MOSFET Die,SUP-0075,4222,Medium
DIO-AUTO-PROT023,Epoxy Molding Compound,SUP-0094,5642,Medium
DIO-AUTO-PROT023,Standard Silicon Wafer (300mm),SUP-0176,17223,Medium
DIO-AUTO-PROT023,GaN HEMT Transistor Die,SUP-0171,5574,Medium
DIO-AUTO-PROT023,High-Side Power Switch IC,SUP-0100,11890,Medium
DIO-AUTO-PROT023,Automotive Protection Diode Array,SUP-0162,10371,Medium
DIO-AUTO-PROT023,Low Dropout Regulator (LDO),SUP-0077,5937,Medium
DIO-AUTO-PROT024,Low Dropout Regulator (LDO),SUP-0096,55575,Medium
DIO-AUTO-PROT024,Automotive Protection Diode Array,SUP-0018,16605,Medium
DIO-AUTO-PROT024,Standard Silicon Wafer (300mm),SUP-0126,1978,Medium
DIO-AUTO-PROT024,High-Side Power Switch IC,SUP-0178,11608,Medium`;

function seedDatabase() {
  console.log('Starting database seeding...');

  // Parse CSV data
  const suppliers = parse(supplierData, { columns: true, skip_empty_lines: true });
  const risks = parse(riskData, { columns: true, skip_empty_lines: true });
  const components = parse(componentData, { columns: true, skip_empty_lines: true });

  // Temporarily disable foreign key checks during seeding
  db.pragma('foreign_keys = OFF');

  // Clear existing data
  db.exec('DELETE FROM alerts');
  db.exec('DELETE FROM diversification_recommendations');
  db.exec('DELETE FROM country_concentration');
  db.exec('DELETE FROM product_components');
  db.exec('DELETE FROM risk_metrics');
  db.exec('DELETE FROM suppliers');

  // Insert suppliers
  const insertSupplier = db.prepare(`
    INSERT INTO suppliers (id, name, tier_level, country, city, site_function, supplies_id, latitude, longitude)
    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
  `);

  // Sort suppliers by tier level (Tier 3 first, then Tier 2, then Tier 1)
  // This ensures foreign key references are satisfied since lower tier suppliers
  // supply to higher tier suppliers
  const sortedSuppliers = [...suppliers].sort((a, b) =>
    parseInt(b.Tier_Level) - parseInt(a.Tier_Level)
  );

  const insertManySuppliers = db.transaction((items) => {
    for (const item of items) {
      insertSupplier.run(
        item.Supplier_ID,
        item.Supplier_Name,
        parseInt(item.Tier_Level),
        item.Site_Location_Country,
        item.Site_Location_City,
        item.Site_Function,
        item.Supplies_ID === 'DIODES_CORP' ? null : item.Supplies_ID,
        parseFloat(item.Latitude),
        parseFloat(item.Longitude)
      );
    }
  });
  insertManySuppliers(sortedSuppliers);
  console.log(`Inserted ${suppliers.length} suppliers`);

  // Insert risk metrics
  const insertRisk = db.prepare(`
    INSERT INTO risk_metrics (supplier_id, geopolitical_risk, natural_disaster_risk, water_scarcity_index, overall_risk_score, esg_audit_score, alternative_source_count)
    VALUES (?, ?, ?, ?, ?, ?, ?)
  `);

  const insertManyRisks = db.transaction((items) => {
    for (const item of items) {
      insertRisk.run(
        item.Supplier_ID,
        parseFloat(item.Geopolitical_Risk_Index),
        parseFloat(item.Natural_Disaster_Risk_Index),
        parseFloat(item.Water_Scarcity_Index),
        parseFloat(item.Overall_Risk_Score),
        parseInt(item.ESG_Audit_Score),
        parseInt(item.Alternative_Source_Count)
      );
    }
  });
  insertManyRisks(risks);
  console.log(`Inserted ${risks.length} risk metrics`);

  // Insert product components
  const insertComponent = db.prepare(`
    INSERT INTO product_components (sku, component_name, supplier_id, annual_volume, criticality)
    VALUES (?, ?, ?, ?, ?)
  `);

  const insertManyComponents = db.transaction((items) => {
    for (const item of items) {
      insertComponent.run(
        item.Diodes_SKU,
        item.Component_Name,
        item.Supplier_ID,
        parseInt(item.Annual_Volume_Units),
        item.Criticality_Flag
      );
    }
  });
  insertManyComponents(components);
  console.log(`Inserted ${components.length} product components`);

  // Calculate and insert country concentration
  const countryStats = db.prepare(`
    SELECT
      country,
      COUNT(*) as supplier_count,
      SUM(CASE WHEN tier_level = 1 THEN 1 ELSE 0 END) as tier1_count,
      SUM(CASE WHEN tier_level = 2 THEN 1 ELSE 0 END) as tier2_count,
      SUM(CASE WHEN tier_level = 3 THEN 1 ELSE 0 END) as tier3_count
    FROM suppliers
    GROUP BY country
  `).all();

  const totalSuppliers = suppliers.length;

  const insertConcentration = db.prepare(`
    INSERT INTO country_concentration (country, supplier_count, tier1_count, tier2_count, tier3_count, avg_risk_score, concentration_percentage, risk_category)
    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
  `);

  for (const stat of countryStats) {
    const avgRisk = db.prepare(`
      SELECT AVG(r.overall_risk_score) as avg_risk
      FROM suppliers s
      JOIN risk_metrics r ON s.id = r.supplier_id
      WHERE s.country = ?
    `).get(stat.country);

    const concentrationPct = (stat.supplier_count / totalSuppliers) * 100;
    let riskCategory = 'Low';
    if (concentrationPct > 25) riskCategory = 'Critical';
    else if (concentrationPct > 15) riskCategory = 'High';
    else if (concentrationPct > 8) riskCategory = 'Medium';

    insertConcentration.run(
      stat.country,
      stat.supplier_count,
      stat.tier1_count,
      stat.tier2_count,
      stat.tier3_count,
      avgRisk?.avg_risk || 0,
      concentrationPct,
      riskCategory
    );
  }
  console.log(`Inserted ${countryStats.length} country concentration records`);

  // Generate diversification recommendations
  const recommendations = [
    {
      category: 'Geographic Diversification',
      priority: 'Critical',
      title: 'Reduce Taiwan Concentration Risk',
      description: 'Taiwan represents 24.5% of total suppliers with highest geopolitical risk (avg 0.96). Identify alternative suppliers in South Korea, Japan, or Southeast Asia for critical components.',
      affected_suppliers: 'SUP-0060, SUP-0063, SUP-0167, SUP-0170, SUP-0176, SUP-0191',
      estimated_impact: 'Reduces single-region dependency by 40%'
    },
    {
      category: 'Geographic Diversification',
      priority: 'Critical',
      title: 'Address China Supply Chain Vulnerabilities',
      description: 'China suppliers show highest overall risk scores (avg 0.86) with elevated geopolitical and water scarcity indices. Establish backup sources in Vietnam or Malaysia.',
      affected_suppliers: 'SUP-0008, SUP-0014, SUP-0160, SUP-0164, SUP-0173',
      estimated_impact: 'Mitigates $15M potential supply disruption'
    },
    {
      category: 'Tier 2 Resilience',
      priority: 'High',
      title: 'Strengthen Silicon Wafer Fabrication Alternatives',
      description: 'Silicon Wafer Fabrication concentrated in high-risk regions. Qualify additional Tier 2 suppliers in Singapore or Germany.',
      affected_suppliers: 'SUP-0065, SUP-0073, SUP-0083, SUP-0101, SUP-0122',
      estimated_impact: 'Adds 3-4 weeks buffer stock capability'
    },
    {
      category: 'Tier 3 Visibility',
      priority: 'High',
      title: 'Map Sub-Tier Raw Material Sources',
      description: 'Multiple Tier 3 suppliers in Specialty Chemical Production and Raw Material Extraction lack visibility. Implement traceability for conflict minerals compliance.',
      affected_suppliers: 'SUP-0000, SUP-0003, SUP-0008, SUP-0018, SUP-0040',
      estimated_impact: 'Ensures regulatory compliance and ESG reporting'
    },
    {
      category: 'Natural Disaster Resilience',
      priority: 'High',
      title: 'Japan Earthquake Preparedness',
      description: 'Japan suppliers show highest natural disaster risk (avg 0.89). Develop dual-sourcing strategy for Kumamoto and Nagasaki facilities.',
      affected_suppliers: 'SUP-0066, SUP-0111, SUP-0128, SUP-0168, SUP-0197',
      estimated_impact: 'Reduces earthquake-related downtime by 60%'
    },
    {
      category: 'ESG Improvement',
      priority: 'Medium',
      title: 'Improve Vietnam Supplier ESG Scores',
      description: 'Vietnam suppliers have lowest average ESG audit scores (68). Implement supplier development programs.',
      affected_suppliers: 'SUP-0003, SUP-0070, SUP-0082, SUP-0166, SUP-0178',
      estimated_impact: 'Improves ESG rating by 15 points average'
    },
    {
      category: 'Alternative Sourcing',
      priority: 'Medium',
      title: 'Develop Alternative Sources for Single-Source Components',
      description: '15 suppliers have zero alternative sources identified. Critical for SiC/GaN substrates and specialty gases.',
      affected_suppliers: 'SUP-0002, SUP-0004, SUP-0014, SUP-0047, SUP-0062',
      estimated_impact: 'Eliminates single points of failure'
    },
    {
      category: 'Water Scarcity',
      priority: 'Medium',
      title: 'Address Singapore Water Dependency',
      description: 'Singapore suppliers show highest water scarcity index (avg 0.78). Evaluate water recycling investments or regional alternatives.',
      affected_suppliers: 'SUP-0010, SUP-0042, SUP-0108, SUP-0131, SUP-0177',
      estimated_impact: 'Reduces water supply risk by 25%'
    }
  ];

  const insertRecommendation = db.prepare(`
    INSERT INTO diversification_recommendations (category, priority, title, description, affected_suppliers, estimated_impact)
    VALUES (?, ?, ?, ?, ?, ?)
  `);

  for (const rec of recommendations) {
    insertRecommendation.run(
      rec.category,
      rec.priority,
      rec.title,
      rec.description,
      rec.affected_suppliers,
      rec.estimated_impact
    );
  }
  console.log(`Inserted ${recommendations.length} diversification recommendations`);

  // Generate alerts
  const alerts = [
    {
      alert_type: 'concentration_risk',
      severity: 'Critical',
      title: 'Critical Geographic Concentration - Taiwan',
      message: 'Taiwan accounts for 24.5% of supply chain with 49 suppliers. Geopolitical tensions present significant risk to operations.',
      supplier_id: null,
      country: 'Taiwan'
    },
    {
      alert_type: 'concentration_risk',
      severity: 'Critical',
      title: 'Critical Geographic Concentration - Japan',
      message: 'Japan accounts for 28.5% of supply chain with 57 suppliers. High natural disaster risk requires contingency planning.',
      supplier_id: null,
      country: 'Japan'
    },
    {
      alert_type: 'high_risk_supplier',
      severity: 'Critical',
      title: 'High Risk Tier 1 Supplier',
      message: 'SUP-0164 (Syn Corp) in China has critical risk score of 0.973. Immediate action required.',
      supplier_id: 'SUP-0164',
      country: 'China'
    },
    {
      alert_type: 'single_source',
      severity: 'High',
      title: 'Single Source Dependency - SiC Power MOSFET',
      message: 'Multiple high-criticality products depend on limited SiC MOSFET sources. Diversification urgent.',
      supplier_id: 'SUP-0168',
      country: 'Japan'
    },
    {
      alert_type: 'esg_concern',
      severity: 'Medium',
      title: 'ESG Audit Score Below Threshold',
      message: '12 suppliers have ESG scores below 70. Review and improvement plans needed for automotive compliance.',
      supplier_id: null,
      country: null
    },
    {
      alert_type: 'natural_disaster',
      severity: 'High',
      title: 'Typhoon Season Alert - Southeast Asia',
      message: 'Seasonal typhoon risk elevated for Vietnam and Taiwan suppliers. Verify inventory buffers.',
      supplier_id: null,
      country: 'Vietnam'
    }
  ];

  const insertAlert = db.prepare(`
    INSERT INTO alerts (alert_type, severity, title, message, supplier_id, country)
    VALUES (?, ?, ?, ?, ?, ?)
  `);

  for (const alert of alerts) {
    insertAlert.run(
      alert.alert_type,
      alert.severity,
      alert.title,
      alert.message,
      alert.supplier_id,
      alert.country
    );
  }
  console.log(`Inserted ${alerts.length} alerts`);

  // Re-enable foreign key checks
  db.pragma('foreign_keys = ON');

  console.log('Database seeding completed successfully!');
}

seedDatabase();
